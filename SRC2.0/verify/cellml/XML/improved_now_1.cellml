<?xml version='1.0' encoding='utf-8'?>
<!--  FILE :  iber_model_2002.xml

CREATED :  6th December 2002

LAST MODIFIED : 27th April 2005

AUTHOR :  Catherine Lloyd
          Bioengineering Institute
          The University of Auckland
          
MODEL STATUS :  This model conforms to the CellML 1.0 Specification released on
10th August 2001, and the 16/01/2002 CellML Metadata 1.0 Specification.

DESCRIPTION :  This file contains a CellML description of Iber and Maini's 2002 mathematical model for germinal centre kinetics and affinity maturation.

CHANGES:  
  27/04/2005 - PJV - Corrected syntax error with base units. Modified
                     initial values to make them valid cellml.
  
--><model xmlns="http://www.cellml.org/cellml/1.0#" xmlns:cmeta="http://www.cellml.org/metadata/1.0#" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:bqs="http://www.cellml.org/bqs/1.0#" xmlns:cellml="http://www.cellml.org/cellml/1.0#" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:vCard="http://www.w3.org/2001/vcard-rdf/3.0#" cmeta:id="iber_maini_2002_version01" name="iber_maini_2002_version01">
<documentation xmlns="http://cellml.org/tmp-documentation">
<article>
  <articleinfo>
  <title>A Mathematical Model for Germinal Centre Kinetics and Affinity Maturation</title>
  <author>
    <firstname>Catherine</firstname>
          <surname>Lloyd</surname>
    <affiliation>
      <shortaffil>Bioengineering Institute, University of Auckland</shortaffil>
    </affiliation>
  </author>
</articleinfo>
  <section id="sec_status">
    <title>Model Status</title>
    <para>
            This is the original unchecked version of the model imported from the previous
            CellML model repository, 24-Jan-2006.
          </para>
  </section>
  <sect1 id="sec_structure">
<title>Model Structure</title>

<para>
Affinity maturation refers to an increase in the affinity of antibodies for the antigen produced during an immune response.  This is achieved by mutation of the genes encoding the antibody, followed by selection for the B cells which express B cell receptors with the highest affinity for antigen.  Both gene mutation and subsequent protein selection occur in the germinal centres of secondary lymphoid organs.  Upon immunisation (infection), the antigen is concentrated in the secondary lymphoid organs, where a small subset of all B cells recognise it.  After successful presentation of the antigen fragments to T cells, B cells enter the blast state.  After about three days, the B blasts differentiate into centroblasts, and then into centrocytes.  Centrocytes express B cell receptors on their surface and they are believed to be subject to selection by antigen in that they need to bind, internalise and present antigen to T cells in order to prevent their under going apoptosis.  Centrocytes that successfully interact with T cells (selected centrocytes), can either differentiate into memory cells, antibody forming cells (AFCs), or they can revert back to the centroblast state (see <xref linkend="fig_reaction_diagram"/> below). 
</para>

<para>
Shortly after the first differentiation of centroblasts into centrocytes, somatic hypermutation starts to act on the centroblasts and changes the affinity of the B cell receptors for the antigen.  About 53% of the mutations are silent, and have no affect on affinity.  About 28% of the mutations are fatal, leading to B cell apoptosis.  The remaining 19% of mutations either increase or decrease affinity.  Selection is therefore needed to select for the mutations leading to an increase in affinity and driving affinity maturation.    
</para>

<para>
The molecular mechanisms underlying these processes are not yet clearly understood, and as yet there is no experimental system available to investigate this.  A mathematical model is therefore useful in investigating hypotheses and comparing their simulation results with available experimental data.  In 2002, Iber and Maini published a mathematical model for germinal centre kinetics and affinity maturation.  They began with a simple model of the primed primary immune response (see <xref linkend="fig_reaction_diagram"/> below), and then in this they embedded the model of affinity maturation.  Model simulations showed that antigen masking by antibodies can drive affinity maturation and provide a stabilising feedback mechanism.  Iber and Maini proposed that the selection probability of centrocytes and the recycling probability of selected centrocytes vary over time.  They also show that the efficiency of affinity maturation is highest if clones with a very high affinity antigen leave the germinal centre for either the memory or the plasma cell pool.  It is further shown that the termination of somatic hypermutation for several days before the end of the germinal centre immune reaction is beneficial for affinity maturation.   
</para>

<para>
The complete original paper reference is cited below:
</para>

<para>
A Mathematical Model for Germinal Centre Kinetics and Affinity Maturation, Dagmar Iber and Philip K. Maini, 2002, <emphasis>Journal of Theoretical Biology</emphasis>, 219, 153-175.    <ulink url="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&amp;db=PubMed&amp;list_uids=12413873&amp;dopt=Abstract">PubMed ID: 12413873</ulink>  
</para>


<informalfigure float="0" id="fig_reaction_diagram">
<mediaobject>
  <imageobject>
    <objectinfo>
      <title>reaction schematic for the model</title>
    </objectinfo>
    <imagedata fileref="iber_2002.png"/>
  </imageobject>
</mediaobject>
<caption>A schematic diagram showing the model scheme for the primed primary immune response.</caption>
</informalfigure>

</sect1>
</article>
</documentation>
  
  
  <!--
    Below, are defined some additional units for association with variables and
    constants within the model. 
  -->
  
  <units name="day">
    <unit units="second" multiplier="86400"/>
  </units>
  
  <units base_units="yes" name="cell_number"/>
  
  <units base_units="yes" name="particle"/>
  
  <units base_units="yes" name="antibody"/>
  
  <units base_units="yes" name="generation_number"/>
  
  <units name="per_day">  
    <unit units="day" exponent="-1"/>
  </units>
  
  <units name="per_particle">  
    <unit units="particle" exponent="-1"/>
  </units>
  
  <units name="per_day_per_particle">
    <unit units="day" exponent="-1"/>  
    <unit units="particle" exponent="-1"/>
  </units>
  
  <units name="particle_per_cell_day">
    <unit units="particle"/>
    <unit units="cell_number" exponent="-1"/>  
    <unit units="day" exponent="-1"/>
  </units>
  
  <units name="antibody_per_day_cell">
    <unit units="antibody"/>
    <unit units="day" exponent="-1"/>  
    <unit units="cell_number" exponent="-1"/>
  </units>
  
  <component name="environment">
    <variable units="day" public_interface="out" name="time"/>
    <variable units="per_day" public_interface="out" name="rho"/>
    <variable units="per_day" public_interface="out" name="d"/>
    <variable units="generation_number" public_interface="out" name="n"/>
    
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply id="rho_calculation">
        <eq/>
        <ci> rho </ci>
        <apply>
          <times/>
          <apply>
            <divide/>
            <cn cellml:units="per_day"> 24.0 </cn>
            <cn cellml:units="dimensionless"> 6.5 </cn>
          </apply>
          <apply>
            <ln/>
            <cn cellml:units="dimensionless"> 2.0 </cn>
          </apply>
        </apply>
      </apply>
      
      <apply id="d_calculation">
        <eq/>
        <ci> d </ci>
        <apply>
          <times/>
          <cn cellml:units="per_day"> 12.0 </cn>
          <apply>
            <ln/>
            <cn cellml:units="dimensionless"> 2.0 </cn>
          </apply>
        </apply>
      </apply>
    </math>
  </component>
  
  <component name="recycling_probability">
    <variable units="dimensionless" public_interface="out" name="pr"/>
    <variable units="dimensionless" public_interface="out" name="pr1"/>
    <variable units="dimensionless" public_interface="out" name="pr2"/>
    
    <variable units="dimensionless" name="eta"/>
    
    <variable units="per_particle" public_interface="in" name="Ag_min"/>
    <variable units="per_particle" public_interface="in" name="Ag"/>
    <variable units="generation_number" public_interface="in" name="n"/>
    <variable units="per_particle" public_interface="in" name="K_AgAb"/>
    <variable units="cell_number" public_interface="in" name="C1"/>
    <variable units="cell_number" public_interface="in" name="C2"/>
    <variable units="day" public_interface="in" name="time"/>
    
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply id="pr_calculation">
        <eq/>
        <ci> pr </ci>
        <apply>
          <plus/>
          <cn cellml:units="dimensionless"> 0.6 </cn>
          <apply>
            <times/>
            <cn cellml:units="dimensionless"> 0.2 </cn>
            <apply>
              <divide/>
              <apply>
                <power/>
                <ci> Ag </ci>
                <ci> n </ci>
              </apply>
              <apply>
                <plus/>
                <apply>
                  <power/>
                  <ci> Ag </ci>
                  <ci> n </ci>
                </apply>
                <apply>
                  <power/>
                  <ci> Ag_min </ci>
                  <ci> n </ci>
                </apply>
              </apply>
            </apply>
          </apply>
        </apply>
      </apply>
      
      <apply id="pr1_calculation">
        <eq/>
        <ci> pr1 </ci>
        <cn cellml:units="dimensionless"> 0.95 </cn>
      </apply>
      
      <apply id="pr2_calculation">
        <eq/>
        <ci> pr2 </ci>
        <apply>
          <times/>
          <cn cellml:units="dimensionless"> 0.7 </cn>
          <ci> eta </ci>
        </apply>
      </apply>
      
      <apply id="eta_calculation">
        <eq/>
        <ci> eta </ci>
        <piecewise>
          <piece>
            <apply>
              <divide/>
              <ci> K_AgAb </ci>
              <apply>
                <plus/>
                <ci> C1 </ci>
                <ci> C2 </ci>
              </apply>
            </apply>
            <apply>
              <lt/>
              <apply>
                <divide/>
                <ci> K_AgAb </ci>
                <apply>
                  <plus/>
                  <ci> C1 </ci>
                  <ci> C2 </ci>
                </apply>
              </apply>
              <cn cellml:units="dimensionless"> 1.0 </cn>
            </apply>
          </piece>
          <otherwise>
            <cn cellml:units="dimensionless"> 1.0 </cn>
          </otherwise>
        </piecewise>
      </apply>
    </math>
  </component>
  
  <component name="antigens">
    <variable units="per_particle" public_interface="out" name="Ag_min"/>
    <variable units="per_particle" public_interface="out" name="Ag" initial_value="2500.0"/>
    <variable units="per_day_per_particle" public_interface="out" name="k_on" initial_value="5.0E-13"/>
    
    <variable units="dimensionless" name="k" initial_value="0.0"/>
    <variable units="particle_per_cell_day" name="u" initial_value="1.0E-4"/>
    
    <variable units="cell_number" public_interface="in" name="C"/>
    <variable units="cell_number" public_interface="in" name="Cs"/>
    <variable units="per_particle" public_interface="in" name="Ab"/>
    <variable units="day" public_interface="in" name="time"/>
    
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply id="Ag_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> Ag </ci>
        </apply>
        <apply>
          <minus/>
          <apply>
            <times/>
            <apply>
              <minus/>
              <apply>
                <plus/>
                <apply>
                  <times/>
                  <ci> u </ci>
                  <ci> k </ci>
                  <ci> C </ci>
                </apply>
                <apply>
                  <times/>
                  <ci> u </ci>
                  <ci> Cs </ci>
                  <apply>
                    <minus/>
                    <cn cellml:units="dimensionless"> 1.0 </cn>
                    <ci> k </ci>
                  </apply>
                </apply>
              </apply>
            </apply>
            <ci> Ag </ci>
          </apply>
          <apply>
            <times/>
            <ci> k_on </ci>
            <ci> Ag </ci>
            <ci> Ab </ci>
          </apply>
        </apply>
      </apply>
    </math>
  </component>
  
  <component name="antibodies">
    <variable units="per_particle" public_interface="out" name="Ab"/>
    
    <variable units="antibody_per_day_cell" name="beta" initial_value="1.0E8"/>
    <variable units="per_day_per_particle" public_interface="in" name="k_on"/>
    <variable units="cell_number" public_interface="in" name="AFC"/>
    <variable units="per_particle" public_interface="in" name="Ag"/>
    <variable units="day" public_interface="in" name="time"/>
    
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply id="Ab_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> Ab </ci>
        </apply>
        <apply>
          <minus/>
          <apply>
            <times/>
            <ci> beta </ci>
            <ci> AFC </ci>
          </apply>
          <apply>
            <times/>
            <ci> k_on </ci>
            <ci> Ag </ci>
            <ci> Ab </ci>
          </apply>
        </apply>
      </apply>
    </math>
  </component>
  
  <component name="antigen_antibody_complexes">
    <variable units="dimensionless" public_interface="out" name="theta"/>
    <variable units="per_particle" public_interface="out" name="K_AgAb"/>
    
    <variable units="per_day_per_particle" public_interface="in" name="k_on"/>
    <variable units="per_particle" public_interface="in" name="Ab"/>
    <variable units="per_particle" public_interface="in" name="Ag"/>
    <variable units="cell_number" public_interface="in" name="C1"/>
    <variable units="cell_number" public_interface="in" name="C2"/>
    <variable units="day" public_interface="in" name="time"/>
    
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply id="K_AgAb_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> K_AgAb </ci>
        </apply>
        <apply>
          <times/>
          <ci> k_on </ci>
          <ci> Ag </ci>
          <ci> Ab </ci>
        </apply>
      </apply>
      
      <apply id="theta_calculation">
        <eq/>
        <ci> theta </ci>
        <apply>
          <times/>
          <cn cellml:units="dimensionless"> 0.3 </cn>
          <apply>
            <divide/>
            <ci> Ag </ci>
            <apply>
              <plus/>
              <ci> C1 </ci>
              <ci> C2 </ci>
            </apply>
          </apply>
          <apply>
            <divide/>
            <ci> Ag </ci>
            <apply>
              <plus/>
              <ci> Ag </ci>
              <ci> K_AgAb </ci>
            </apply>
          </apply>
        </apply>
      </apply>
    </math>
  </component>
  
  <component name="selection_probability_of_centrocytes">
    <variable units="dimensionless" public_interface="out" name="s"/>
    <variable units="dimensionless" public_interface="out" name="s1"/>
    <variable units="dimensionless" public_interface="out" name="s2"/>
    
    <variable units="dimensionless" name="h" initial_value="0.07"/>
    <variable units="dimensionless" name="f" initial_value="0.35"/>
    <variable units="dimensionless" name="sc" initial_value="0.45"/>
    <variable units="dimensionless" name="zeta"/>
    
    <variable units="per_particle" public_interface="in" name="Ag_min"/>
    <variable units="per_particle" public_interface="in" name="Ag"/>
    <variable units="generation_number" public_interface="in" name="n"/>
    <variable units="per_day" public_interface="in" name="delta_c"/>
    <variable units="dimensionless" public_interface="in" name="pr"/>
    <variable units="dimensionless" public_interface="in" name="m"/>
    <variable units="per_day" public_interface="in" name="d"/>
    <variable units="cell_number" public_interface="in" name="C1"/>
    <variable units="cell_number" public_interface="in" name="C2"/>
    <variable units="day" public_interface="in" name="time"/>
    
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply id="s_calculation">
        <eq/>
        <ci> s </ci>
        <apply>
          <minus/>
          <ci> sc </ci>
          <apply>
            <plus/>
            <ci> h </ci>
            <apply>
              <times/>
              <ci> f </ci>
              <apply>
                <divide/>
                <apply>
                  <power/>
                  <ci> Ag_min </ci>
                  <ci> n </ci>
                </apply>
                <apply>
                  <plus/>
                  <apply>
                    <power/>
                    <ci> Ag_min </ci>
                    <ci> n </ci>
                  </apply>
                  <apply>
                    <power/>
                    <ci> Ag </ci>
                    <ci> n </ci>
                  </apply>
                </apply>
              </apply>
            </apply>
          </apply>
        </apply>
      </apply>
      
      <apply id="sc_calculation">
        <eq/>
        <ci> sc </ci>
        <apply>
          <divide/>
          <ci> delta_c </ci>
          <apply>
            <plus/>
            <apply>
              <times/>
              <ci> d </ci>
              <apply>
                <minus/>
                <apply>
                  <times/>
                  <cn cellml:units="dimensionless"> 2.0 </cn>
                  <ci> pr </ci>
                  <ci> m </ci>
                </apply>
                <cn cellml:units="dimensionless"> 1.0 </cn>
              </apply>
            </apply>
            <ci> delta_c </ci>
          </apply>
        </apply>
      </apply>
      
      <apply id="s1_calculation">
        <eq/>
        <ci> s1 </ci>
        <apply>
          <plus/>
          <cn cellml:units="dimensionless"> 0.01 </cn>
          <apply>
            <times/>
            <cn cellml:units="dimensionless"> 0.09 </cn>
            <ci> zeta </ci>
          </apply>
        </apply>
      </apply>
      
      <apply id="s2_calculation">
        <eq/>
        <ci> s2 </ci>
        <apply>
          <plus/>
          <cn cellml:units="dimensionless"> 0.1 </cn>
          <apply>
            <times/>
            <cn cellml:units="dimensionless"> 0.85 </cn>
            <ci> zeta </ci>
          </apply>
        </apply>
      </apply>
      
      <apply id="zeta_calculation">
        <eq/>
        <ci> zeta </ci>
        <apply>
          <divide/>
          <ci> Ag </ci>
          <apply>
            <plus/>
            <ci> C1 </ci>
            <ci> C2 </ci>
          </apply>
        </apply>
      </apply>
    </math>
  </component>              
  
  <component name="centroblasts">
    <variable units="cell_number" public_interface="out" name="B"/>
    <variable units="cell_number" public_interface="out" name="B1"/>
    <variable units="cell_number" public_interface="out" name="B2"/>
    
    <variable units="day" public_interface="in" name="time"/>
    <variable units="dimensionless" public_interface="in" name="pr"/>
    <variable units="dimensionless" public_interface="in" name="pr1"/>
    <variable units="dimensionless" public_interface="in" name="pr2"/>
    <variable units="per_day" public_interface="in" name="rho"/>
    <variable units="cell_number" public_interface="in" name="Cs1"/>
    <variable units="cell_number" public_interface="in" name="Cs2"/>
    
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply id="B_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> B </ci>
        </apply>
        <apply>
          <times/>
          <ci> rho </ci>
          <ci> B </ci>
        </apply>
      </apply>
      
      <apply id="B1_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> B1 </ci>
        </apply>
        <apply>
          <minus/>
          <apply>
            <times/>
            <ci> pr1 </ci>
            <ci> rho </ci>
            <ci> Cs1 </ci>
          </apply>
          <apply>
            <times/>
            <ci> rho </ci>
            <ci> B1 </ci>
          </apply>
        </apply>
      </apply>
      
      <apply id="B2_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> B2 </ci>
        </apply>
        <apply>
          <minus/>
          <apply>
            <times/>
            <ci> pr2 </ci>
            <ci> rho </ci>
            <ci> Cs2 </ci>
          </apply>
          <apply>
            <times/>
            <ci> rho </ci>
            <ci> B2 </ci>
          </apply>
        </apply>
      </apply>
    </math>
  </component>
  
  <component name="centrocytes">
    <variable units="cell_number" public_interface="out" name="C"/>
    <variable units="cell_number" public_interface="out" name="C1"/>
    <variable units="cell_number" public_interface="out" name="C2"/>
    <variable units="dimensionless" public_interface="out" name="m" initial_value="0.72"/>
    <variable units="per_day" public_interface="out" name="delta_c"/>
    
    <variable units="per_day" name="mu"/>
    <variable units="per_day" name="mu1"/>
    <variable units="per_day" name="mu2"/>
    <variable units="dimensionless" name="M11"/>
    <variable units="dimensionless" name="M12"/>
    <variable units="dimensionless" name="M21"/>
    <variable units="dimensionless" name="M22"/>
    
    <variable units="day" public_interface="in" name="time"/>
    <variable units="per_day" public_interface="in" name="rho"/>
    <variable units="cell_number" public_interface="in" name="B"/>
    <variable units="cell_number" public_interface="in" name="B1"/>
    <variable units="cell_number" public_interface="in" name="B2"/>
    <variable units="per_day" public_interface="in" name="d"/>
    <variable units="dimensionless" public_interface="in" name="s"/>
    <variable units="dimensionless" public_interface="in" name="s1"/>
    <variable units="dimensionless" public_interface="in" name="s2"/>
    
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply id="C_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> C </ci>
        </apply>
        <apply>
          <minus/>
          <apply>
            <times/>
            <cn cellml:units="dimensionless"> 2.0 </cn>
            <ci> rho </ci>
            <ci> m </ci>
            <ci> B </ci>
          </apply>
          <apply>
            <times/>
            <ci> mu </ci>
            <ci> C </ci>
          </apply>
        </apply>
      </apply>
      
      <apply id="C1_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> C1 </ci>
        </apply>
        <apply>
          <minus/>
          <apply>
            <times/>
            <cn cellml:units="dimensionless"> 2.0 </cn>
            <ci> rho </ci>
            <ci> m </ci>
            <apply>
              <plus/>
              <ci> M11 </ci>
              <ci> B1 </ci>
            </apply>
            <apply>
              <plus/>
              <ci> M12 </ci>
              <ci> B2 </ci>
            </apply>
          </apply>
          <apply>
            <times/>
            <ci> mu1 </ci>
            <ci> C1 </ci>
          </apply>
        </apply>
      </apply>
      
      <apply id="C2_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> C2 </ci>
        </apply>
        <apply>
          <minus/>
          <apply>
            <times/>
            <cn cellml:units="dimensionless"> 2.0 </cn>
            <ci> rho </ci>
            <ci> m </ci>
            <apply>
              <plus/>
              <ci> M21 </ci>
              <ci> B1 </ci>
            </apply>
            <apply>
              <plus/>
              <ci> M22 </ci>
              <ci> B2 </ci>
            </apply>
          </apply>
          <apply>
            <times/>
            <ci> mu2 </ci>
            <ci> C2 </ci>
          </apply>
        </apply>
      </apply>
      
      <apply id="mu_calculation">
        <eq/>
        <ci> mu </ci>
        <apply>
          <plus/>
          <apply>
            <times/>
            <ci> d </ci>
            <ci> s </ci>
          </apply>
          <apply>
            <times/>
            <ci> delta_c </ci>
            <apply>
              <minus/>
              <cn cellml:units="dimensionless"> 1.0 </cn>
              <ci> s </ci>
            </apply>
          </apply>
        </apply>
      </apply>
      
      <apply id="mu1_calculation">
        <eq/>
        <ci> mu1 </ci>
        <apply>
          <plus/>
          <apply>
            <times/>
            <ci> d </ci>
            <ci> s1 </ci>
          </apply>
          <apply>
            <times/>
            <ci> delta_c </ci>
            <apply>
              <minus/>
              <cn cellml:units="dimensionless"> 1.0 </cn>
              <ci> s1 </ci>
            </apply>
          </apply>
        </apply>
      </apply>
      
      <apply id="mu2_calculation">
        <eq/>
        <ci> mu2 </ci>
        <apply>
          <plus/>
          <apply>
            <times/>
            <ci> d </ci>
            <ci> s2 </ci>
          </apply>
          <apply>
            <times/>
            <ci> delta_c </ci>
            <apply>
              <minus/>
              <cn cellml:units="dimensionless"> 1.0 </cn>
              <ci> s2 </ci>
            </apply>
          </apply>
        </apply>
      </apply>
      
      <apply id="delta_c_calculation">
        <eq/>
        <ci> delta_c </ci>
        <apply>
          <times/>
          <cn cellml:units="per_day"> 1.5 </cn>
          <apply>
            <ln/>
            <cn cellml:units="dimensionless"> 2.0 </cn>
          </apply>
        </apply>
      </apply>
      
      <apply id="M11_calculation">
        <eq/>
        <ci> M11 </ci>
        <apply>
          <minus/>
          <cn cellml:units="dimensionless"> 1.0 </cn>
          <ci> M21 </ci>
        </apply>
      </apply>
      
      <apply id="M12_calculation">
        <eq/>
        <ci> M12 </ci>
        <apply>
          <minus/>
          <cn cellml:units="dimensionless"> 1.0 </cn>
          <ci> M22 </ci>
        </apply>
      </apply>
    </math>
  </component>
  
  <component name="selected_centrocytes">
    <variable units="cell_number" public_interface="out" name="Cs"/>
    <variable units="cell_number" public_interface="out" name="Cs1"/>
    <variable units="cell_number" public_interface="out" name="Cs2"/>
    
    <variable units="day" public_interface="in" name="time"/>
    <variable units="per_day" public_interface="in" name="d"/>
    <variable units="dimensionless" public_interface="in" name="s"/>
    <variable units="dimensionless" public_interface="in" name="s1"/>
    <variable units="dimensionless" public_interface="in" name="s2"/>
    <variable units="per_day" public_interface="in" name="rho"/>
    <variable units="cell_number" public_interface="in" name="C"/>
    <variable units="cell_number" public_interface="in" name="C1"/>
    <variable units="cell_number" public_interface="in" name="C2"/>
    
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply id="Cs_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> Cs </ci>
        </apply>
        <apply>
          <minus/>
          <apply>
            <times/>
            <ci> d </ci>
            <ci> s </ci>
            <ci> C </ci>
          </apply>
          <apply>
            <times/>
            <ci> rho </ci>
            <ci> Cs </ci>
          </apply>
        </apply>
      </apply>
      
      <apply id="Cs1_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> Cs1 </ci>
        </apply>
        <apply>
          <minus/>
          <apply>
            <times/>
            <ci> d </ci>
            <ci> s1 </ci>
            <ci> C1 </ci>
          </apply>
          <apply>
            <times/>
            <ci> rho </ci>
            <ci> Cs1 </ci>
          </apply>
        </apply>
      </apply>
      
      <apply id="Cs2_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> Cs2 </ci>
        </apply>
        <apply>
          <minus/>
          <apply>
            <times/>
            <ci> d </ci>
            <ci> s2 </ci>
            <ci> C2 </ci>
          </apply>
          <apply>
            <times/>
            <ci> rho </ci>
            <ci> Cs2 </ci>
          </apply>
        </apply>
      </apply>
    </math>
  </component>
  
  <component name="memory_cells">
    <variable units="cell_number" name="M"/>
    <variable units="cell_number" name="M1"/>
    <variable units="cell_number" name="M2"/>
    
    <variable units="day" public_interface="in" name="time"/>
    <variable units="per_day" public_interface="in" name="rho"/>
    <variable units="dimensionless" public_interface="in" name="pr"/>
    <variable units="dimensionless" public_interface="in" name="pr1"/>
    <variable units="dimensionless" public_interface="in" name="pr2"/>
    <variable units="cell_number" public_interface="in" name="Cs"/>
    <variable units="cell_number" public_interface="in" name="Cs1"/>
    <variable units="cell_number" public_interface="in" name="Cs2"/>
    <variable units="dimensionless" public_interface="in" name="theta"/>
    
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply id="M_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> M </ci>
        </apply>
        <apply>
          <times/>
          <apply>
            <minus/>
            <cn cellml:units="dimensionless"> 1.0 </cn>
            <ci> theta </ci>
          </apply>
          <ci> rho </ci>
          <apply>
            <minus/>
            <cn cellml:units="dimensionless"> 1.0 </cn>
            <ci> pr </ci>
          </apply>
          <ci> Cs </ci>
        </apply>
      </apply>
      
      <apply id="M1_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> M1 </ci>
        </apply>
        <apply>
          <times/>
          <apply>
            <minus/>
            <cn cellml:units="dimensionless"> 1.0 </cn>
            <ci> pr1 </ci>
          </apply>
          <ci> Cs1 </ci>
        </apply>
      </apply>
      
      <apply id="M2_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> M2 </ci>
        </apply>
        <apply>
          <times/>
          <apply>
            <minus/>
            <cn cellml:units="dimensionless"> 1.0 </cn>
            <ci> pr2 </ci>
          </apply>
          <ci> Cs2 </ci>
        </apply>
      </apply>
    </math>
  </component>
  
  <component name="antibody_forming_cells">
    <variable units="cell_number" public_interface="out" name="AFC"/>
   
    <variable units="day" public_interface="in" name="time"/>
    <variable units="dimensionless" public_interface="in" name="pr"/>
    <variable units="per_day" public_interface="in" name="rho"/>
    <variable units="cell_number" public_interface="in" name="Cs"/>
    <variable units="dimensionless" public_interface="in" name="theta"/>
    
    <math xmlns="http://www.w3.org/1998/Math/MathML">
      <apply id="AFC_diff_eq">
        <eq/>
        <apply>
          <diff/>
          <bvar>
            <ci> time </ci>
          </bvar>
          <ci> AFC </ci>
        </apply>
        <apply>
          <times/>
          <ci> theta </ci>
          <ci> rho </ci>
          <apply>
            <minus/>
            <cn cellml:units="dimensionless"> 1.0 </cn>
            <ci> pr </ci>
          </apply>
          <ci> Cs </ci>
        </apply>
      </apply>
    </math>
  </component>
  
  <connection>
    <map_components component_2="environment" component_1="recycling_probability"/>
    <map_variables variable_2="time" variable_1="time"/>
    <map_variables variable_2="n" variable_1="n"/>
  </connection>
  
  <connection>
    <map_components component_2="environment" component_1="antigens"/>
    <map_variables variable_2="time" variable_1="time"/>
  </connection>
  
  <connection>
    <map_components component_2="environment" component_1="antibodies"/>
    <map_variables variable_2="time" variable_1="time"/>
  </connection>
  
  <connection>
    <map_components component_2="environment" component_1="antigen_antibody_complexes"/>
    <map_variables variable_2="time" variable_1="time"/>
  </connection>
  
  <connection>
    <map_components component_2="environment" component_1="selection_probability_of_centrocytes"/>
    <map_variables variable_2="time" variable_1="time"/>
    <map_variables variable_2="n" variable_1="n"/>
    <map_variables variable_2="d" variable_1="d"/>
  </connection>
  
  <connection>
    <map_components component_2="environment" component_1="centroblasts"/>
    <map_variables variable_2="time" variable_1="time"/>
    <map_variables variable_2="rho" variable_1="rho"/>
  </connection>
  
  <connection>
    <map_components component_2="environment" component_1="centrocytes"/>
    <map_variables variable_2="time" variable_1="time"/>
    <map_variables variable_2="rho" variable_1="rho"/>
    <map_variables variable_2="d" variable_1="d"/>
  </connection>
  
  <connection>
    <map_components component_2="environment" component_1="selected_centrocytes"/>
    <map_variables variable_2="time" variable_1="time"/>
    <map_variables variable_2="rho" variable_1="rho"/>
    <map_variables variable_2="d" variable_1="d"/>
  </connection>
  
  <connection>
    <map_components component_2="environment" component_1="memory_cells"/>
    <map_variables variable_2="time" variable_1="time"/>
    <map_variables variable_2="rho" variable_1="rho"/>
  </connection>
  
  <connection>
    <map_components component_2="environment" component_1="antibody_forming_cells"/>
    <map_variables variable_2="time" variable_1="time"/>
    <map_variables variable_2="rho" variable_1="rho"/>
  </connection>
  
  <connection>
    <map_components component_2="selection_probability_of_centrocytes" component_1="recycling_probability"/>
    <map_variables variable_2="pr" variable_1="pr"/>
  </connection>
  
  <connection>
    <map_components component_2="centroblasts" component_1="recycling_probability"/>
    <map_variables variable_2="pr" variable_1="pr"/>
    <map_variables variable_2="pr1" variable_1="pr1"/>
    <map_variables variable_2="pr2" variable_1="pr2"/>
  </connection>
  
  <connection>
    <map_components component_2="memory_cells" component_1="recycling_probability"/>
    <map_variables variable_2="pr" variable_1="pr"/>
    <map_variables variable_2="pr1" variable_1="pr1"/>
    <map_variables variable_2="pr2" variable_1="pr2"/>
  </connection>
  
  <connection>
    <map_components component_2="antigen_antibody_complexes" component_1="recycling_probability"/>
    <map_variables variable_2="K_AgAb" variable_1="K_AgAb"/>
  </connection>
  
  <connection>
    <map_components component_2="antibody_forming_cells" component_1="recycling_probability"/>
    <map_variables variable_2="pr" variable_1="pr"/>
  </connection>
  
  <connection>
    <map_components component_2="antigens" component_1="recycling_probability"/>
    <map_variables variable_2="Ag_min" variable_1="Ag_min"/>
    <map_variables variable_2="Ag" variable_1="Ag"/>
  </connection>
  
  <connection>
    <map_components component_2="antigens" component_1="selection_probability_of_centrocytes"/>
    <map_variables variable_2="Ag_min" variable_1="Ag_min"/>
    <map_variables variable_2="Ag" variable_1="Ag"/>
  </connection>
  
  <connection>
    <map_components component_2="antigens" component_1="antibodies"/>
    <map_variables variable_2="k_on" variable_1="k_on"/>
    <map_variables variable_2="Ag" variable_1="Ag"/>
    <map_variables variable_2="Ab" variable_1="Ab"/>
  </connection>
  
  <connection>
    <map_components component_2="antigens" component_1="antigen_antibody_complexes"/>
    <map_variables variable_2="k_on" variable_1="k_on"/>
    <map_variables variable_2="Ag" variable_1="Ag"/>
  </connection>
  
  <connection>
    <map_components component_2="antigens" component_1="centrocytes"/>
    <map_variables variable_2="C" variable_1="C"/>
  </connection>
  
  <connection>
    <map_components component_2="recycling_probability" component_1="centrocytes"/>
    <map_variables variable_2="C1" variable_1="C1"/>
    <map_variables variable_2="C2" variable_1="C2"/>
  </connection>
  
  <connection>
    <map_components component_2="antigens" component_1="selected_centrocytes"/>
    <map_variables variable_2="Cs" variable_1="Cs"/>
  </connection>
  
  <connection>
    <map_components component_2="antibodies" component_1="antigen_antibody_complexes"/>
    <map_variables variable_2="Ab" variable_1="Ab"/>
  </connection>
  
  <connection>
    <map_components component_2="antibodies" component_1="antibody_forming_cells"/>
    <map_variables variable_2="AFC" variable_1="AFC"/>
  </connection>
  
  <connection>
    <map_components component_2="memory_cells" component_1="antigen_antibody_complexes"/>
    <map_variables variable_2="theta" variable_1="theta"/>
  </connection>
  
  <connection>
    <map_components component_2="antibody_forming_cells" component_1="antigen_antibody_complexes"/>
    <map_variables variable_2="theta" variable_1="theta"/>
  </connection>
  
  <connection>
    <map_components component_2="centrocytes" component_1="antigen_antibody_complexes"/>
    <map_variables variable_2="C1" variable_1="C1"/>
    <map_variables variable_2="C2" variable_1="C2"/>
  </connection>
  
  <connection>
    <map_components component_2="centrocytes" component_1="selection_probability_of_centrocytes"/>
    <map_variables variable_2="delta_c" variable_1="delta_c"/>
    <map_variables variable_2="m" variable_1="m"/>
    <map_variables variable_2="s" variable_1="s"/>
    <map_variables variable_2="s1" variable_1="s1"/>
    <map_variables variable_2="s2" variable_1="s2"/>
    <map_variables variable_2="C1" variable_1="C1"/>
    <map_variables variable_2="C2" variable_1="C2"/>
  </connection>
  
  <connection>
    <map_components component_2="selected_centrocytes" component_1="selection_probability_of_centrocytes"/>
    <map_variables variable_2="s" variable_1="s"/>
    <map_variables variable_2="s1" variable_1="s1"/>
    <map_variables variable_2="s2" variable_1="s2"/>
  </connection>
  
  <connection>
    <map_components component_2="selected_centrocytes" component_1="centroblasts"/>
    <map_variables variable_2="Cs1" variable_1="Cs1"/>
    <map_variables variable_2="Cs2" variable_1="Cs2"/>
  </connection>
  
  <connection>
    <map_components component_2="centrocytes" component_1="centroblasts"/>
    <map_variables variable_2="B" variable_1="B"/>
    <map_variables variable_2="B1" variable_1="B1"/>
    <map_variables variable_2="B2" variable_1="B2"/>
  </connection>
  
  <connection>
    <map_components component_2="selected_centrocytes" component_1="centrocytes"/>
    <map_variables variable_2="C" variable_1="C"/>
    <map_variables variable_2="C1" variable_1="C1"/>
    <map_variables variable_2="C2" variable_1="C2"/>
  </connection>
  
  <connection>
    <map_components component_2="selected_centrocytes" component_1="memory_cells"/>
    <map_variables variable_2="Cs" variable_1="Cs"/>
    <map_variables variable_2="Cs1" variable_1="Cs1"/>
    <map_variables variable_2="Cs2" variable_1="Cs2"/>
  </connection>
  
   <connection>
    <map_components component_2="antibody_forming_cells" component_1="selected_centrocytes"/>
    <map_variables variable_2="Cs" variable_1="Cs"/>
  </connection>


<rdf:RDF>
  <rdf:Bag rdf:about="rdf:#eca548cd-390c-4bd9-bbce-928c90a4f2ab">
    <rdf:li>germinal centre kinetics</rdf:li>
    <rdf:li>immunology</rdf:li>
    <rdf:li>gene regulation</rdf:li>
  </rdf:Bag>
  <rdf:Seq rdf:about="rdf:#0b028687-7806-42ae-944c-b6a52a0940b9">
    <rdf:li rdf:resource="rdf:#353e307a-203a-4c5a-884f-b301d4187496"/>
    <rdf:li rdf:resource="rdf:#243e72ef-0dd7-41e2-8f17-563054697f72"/>
  </rdf:Seq>
  <rdf:Description rdf:about="rdf:#b878aa9f-193a-42ef-851e-47bdb0bf8e34">
    <dc:title>Journal of Theoretical Biology</dc:title>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#9ed88621-9acd-4282-a1c8-37b64a141d8a">
    <bqs:subject_type>keyword</bqs:subject_type>
    <rdf:value rdf:resource="rdf:#eca548cd-390c-4bd9-bbce-928c90a4f2ab"/>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#353e307a-203a-4c5a-884f-b301d4187496">
    <rdf:type rdf:resource="http://www.cellml.org/bqs/1.0#Person"/>
    <vCard:N rdf:resource="rdf:#3e444364-b5ed-4444-a972-4a158c7f57b9"/>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#5672e1bc-409e-4bb9-b00f-138108aa1518">
    <dcterms:W3CDTF>2002-12-06</dcterms:W3CDTF>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#7046adfd-27e0-4198-b41c-12c1e1f19b3e">
    <dcterms:W3CDTF>2002</dcterms:W3CDTF>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#3ce1e11a-82cc-4c81-ba82-d482b19120f4">
    <dc:subject rdf:resource="rdf:#9ed88621-9acd-4282-a1c8-37b64a141d8a"/>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#4fd5b180-8452-46c3-8523-b90c1134a0bb">
    <dc:creator rdf:resource="rdf:#c303156b-37cc-4a32-8f63-8c84b23b108b"/>
    <rdf:value>
          This is the CellML description of Iber and Maini's 2002 mathematical 
          model for germinal centre kinetics and affinity maturation.
        </rdf:value>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#223de3cc-0701-4897-9e81-66a5b65eb226">
    <vCard:Orgname>The University of Auckland</vCard:Orgname>
    <vCard:Orgunit>The Bioengineering Institute</vCard:Orgunit>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#3e444364-b5ed-4444-a972-4a158c7f57b9">
    <vCard:Given>Dagmar</vCard:Given>
    <vCard:Family>Iber</vCard:Family>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#243e72ef-0dd7-41e2-8f17-563054697f72">
    <rdf:type rdf:resource="http://www.cellml.org/bqs/1.0#Person"/>
    <vCard:N rdf:resource="rdf:#c62f140c-44ee-4237-b2f5-ac9c6425ff9e"/>
  </rdf:Description>
  <rdf:Description rdf:about="#iber_maini_2002_version01">
    <dc:title>
         Iber and Maini's 2002 mathematical model for germinal centre kinetics 
         and affinity maturation.
      </dc:title>
    <cmeta:comment rdf:resource="rdf:#4fd5b180-8452-46c3-8523-b90c1134a0bb"/>
    <bqs:reference rdf:resource="rdf:#3ce1e11a-82cc-4c81-ba82-d482b19120f4"/>
    <bqs:reference rdf:resource="rdf:#9783cb7c-4f96-4ee3-a116-12df4d68c64a"/>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#b88986cf-0fc9-43dc-ad83-d7ed8cb63e6f">
    <vCard:Given>Catherine</vCard:Given>
    <vCard:Family>Lloyd</vCard:Family>
    <vCard:Other>May</vCard:Other>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#44f0660d-e5b7-47a3-91a5-6d341a5f4547">
    <dc:creator rdf:resource="rdf:#0b028687-7806-42ae-944c-b6a52a0940b9"/>
    <dc:title>
          A Mathematical Model for Germinal Centre Kinetics and Affinity
          Maturation
        </dc:title>
    <bqs:volume>219</bqs:volume>
    <bqs:first_page>153</bqs:first_page>
    <bqs:Journal rdf:resource="rdf:#b878aa9f-193a-42ef-851e-47bdb0bf8e34"/>
    <dcterms:issued rdf:resource="rdf:#7046adfd-27e0-4198-b41c-12c1e1f19b3e"/>
    <bqs:last_page>175</bqs:last_page>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#7b486bf4-f2e8-4f16-872a-2dcd3fb79640">
    <rdf:type rdf:resource="http://imc.org/vCard/3.0#internet"/>
    <rdf:value>c.lloyd@auckland.ac.nz</rdf:value>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#9783cb7c-4f96-4ee3-a116-12df4d68c64a">
    <bqs:JournalArticle rdf:resource="rdf:#44f0660d-e5b7-47a3-91a5-6d341a5f4547"/>
  </rdf:Description>
  <rdf:Description rdf:about="">
    <dc:publisher>
        The University of Auckland, Bioengineering Institute
      </dc:publisher>
    <dcterms:created rdf:resource="rdf:#5672e1bc-409e-4bb9-b00f-138108aa1518"/>
    <dc:creator rdf:resource="rdf:#adec234b-24d1-4f1b-ba25-8f5c70c88992"/>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#c62f140c-44ee-4237-b2f5-ac9c6425ff9e">
    <vCard:Given>Philip</vCard:Given>
    <vCard:Family>Maini</vCard:Family>
    <vCard:Other>K</vCard:Other>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#adec234b-24d1-4f1b-ba25-8f5c70c88992">
    <vCard:ORG rdf:resource="rdf:#223de3cc-0701-4897-9e81-66a5b65eb226"/>
    <vCard:EMAIL rdf:resource="rdf:#7b486bf4-f2e8-4f16-872a-2dcd3fb79640"/>
    <vCard:N rdf:resource="rdf:#b88986cf-0fc9-43dc-ad83-d7ed8cb63e6f"/>
  </rdf:Description>
  <rdf:Description rdf:about="rdf:#c303156b-37cc-4a32-8f63-8c84b23b108b">
    <vCard:FN>Catherine Lloyd</vCard:FN>
  </rdf:Description>
</rdf:RDF>
</model>
