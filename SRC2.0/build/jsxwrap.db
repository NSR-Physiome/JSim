#!/bin/sh

# create JSim wrappers for XSim-style models

. jsbuild.path

# program usage
usage() {
  echo "Usage: jsxwrap.db [-f -c] model-name objects libs"
  exit 1
}

if [ $# -lt 3 ]
then
  usage
fi

LANG="$1"
shift
MODEL="$1"
shift
OBJECTS="$*"

# generate wrapper C code: jsx"$MODEL".c
jsrun.db JSim.text.JSXWrap $LANG $MODEL $OBJECTS
if [ $? -ne 0 ]
then
  echo "JSim wrapper generation failed"
  exit 1
fi

# compile wrapper to F&P library
export XFP_OBJS="$OBJECTS"
make -f $JSIMSRC/JSim/nonJava/Makefile.global.nml jsx"$MODEL".xfp
if [ $? -ne 0 ]
then
  echo "JSim wrapper compilation failed"
  exit 1
fi

